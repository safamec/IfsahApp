@using Microsoft.AspNetCore.Antiforgery
@inject IAntiforgery Antiforgery
@{
    var reportNumber = (string?)ViewData["ReportNumber"] ?? "";
    ViewData["Title"] = "Thank You for Your Report";
    var tokens = Antiforgery.GetAndStoreTokens(Context);
}

<link rel="stylesheet" href="~/css/thankyou.css" />

<!-- CSRF token for JS -->
<meta name="csrf-token" content="@tokens.RequestToken" />

<style>
  /* تأكد أن التوست يظهر بالأعلى */
  .ty-toast{ top:24px; bottom:auto; }
</style>

<div class="ty-container" dir="rtl">
    <h1 class="ty-title">شكراً لتقديم البلاغ!</h1>
    <h2 class="ty-subtitle">تم استلام بلاغك وسيُتعامل معه بسرعة وبعناية</h2>

    <p class="ty-report">رقم البلاغ: <strong>@reportNumber</strong></p>

    <hr class="ty-sep" />

    <div class="ty-subscribe">
        <h3 class="ty-section-title">استلام إشعار بالبريد الإلكتروني عن حالة البلاغ</h3>

        <div class="ty-form">
            <input id="notifyEmail" type="email" placeholder="أدخلي البريد الإلكتروني"
                   inputmode="email" autocomplete="email" />
            <button id="verifyBtn" class="ty-btn ty-btn-accent" type="button">تحقيق</button>
            <div id="loader" class="ty-loader" aria-hidden="true"></div>
        </div>

        <div id="toast" class="ty-toast" role="status" aria-live="polite"></div>

        <p class="ty-hint">سنرسل تحديثات عن حالة البلاغ على البريد عند توفر جديد.</p>
    </div>
</div>

<script>
  // تمرير البيانات للـ JS
  window.REPORT_NO = "@reportNumber";
  window.SUBSCRIBE_URL = "@Url.Action("SubscribeEmail", "Disclosure")";
</script>
<script src="~/js/report-subscribe.js"></script>
