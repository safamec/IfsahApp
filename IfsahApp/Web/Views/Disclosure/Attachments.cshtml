@model IfsahApp.Core.ViewModels.DisclosureFormViewModel
@inject Microsoft.AspNetCore.Mvc.Localization.IViewLocalizer Localizer

@{
    ViewData["Title"] = Localizer["Attachments"];
    ViewData["Step"]  = 4;
}

@section StepTabs { @await Html.PartialAsync("_DisclosureTabs") }

<h3>@Localizer["Attachments"]</h3>

<form asp-action="Attachments" method="post" enctype="multipart/form-data" novalidate>
    @Html.AntiForgeryToken()

    <div class="mb-3">
        <label asp-for="Attachments" class="form-label">@Localizer["Choose files"]</label>

        <!-- تعطيل التحقق للمدخل -->
        <input asp-for="Attachments"
               id="attachments"
               type="file"
               multiple
               class="form-control"
               accept=".jpg,.jpeg,.png,.gif,.bmp,.mp4,.mov,.avi,.wmv,.mkv,.pdf,.doc,.docx,.xls,.xlsx,.ppt,.pptx"
               data-val="false" />

        <small class="text-muted d-block mt-1">
            @Localizer["Allowed types: Images, Video, PDF, Word, Excel, PowerPoint (Max 10MB each)"]
        </small>

        <!-- لو عندك asp-validation-for ممكن يظل؛ لكن لن يظهر Required بعد data-val=false -->
        <span asp-validation-for="Attachments" class="text-danger"></span>
    </div>

    <!-- الملفات الحالية -->
    @if (Model.SavedAttachmentPaths != null && Model.SavedAttachmentPaths.Any())
    {
        <div class="mt-3">
            <strong>@Localizer["Current files"]</strong>
            <ul class="mt-2">
                @foreach (var name in Model.SavedAttachmentPaths)
                {
                    <li><a href="~/tempUploads/@name" target="_blank" rel="noopener">@name</a></li>
                }
            </ul>
        </div>
    }

    <div class="d-flex gap-2 mt-4">
        <!-- رجوع (بدون تحقق عميل) -->
        <button type="submit" name="submitDir" value="back" class="btn btn-secondary" formnovalidate>
            @Localizer["Back"]
        </button>

        <!-- رفع وبقاء في الصفحة -->
        <button type="submit" name="submitDir" value="upload" class="btn btn-outline-primary">
            @Localizer["Upload"]
        </button>

        <!-- التالي (بدون تحقق عميل) -->
        <button type="submit" name="submitDir" value="next" class="btn btn-success" formnovalidate>
            @Localizer["Next"]
        </button>
    </div>
</form>

@section Scripts {
    <!-- لو تستخدمين _ValidationScriptsPartial اتركيه كما هو -->
}
