<script src="~/lib/jquery/jquery.min.js"></script>
<script src="~/lib/bootstrap@5.3.0/js/bootstrap.bundle.min.js"></script>
@await Html.PartialAsync("_ValidationScriptsPartial")
<script>
    document.addEventListener("DOMContentLoaded", () => {
        const checkbox = document.getElementById("theme-checkbox");
        const html = document.documentElement;

        // Function to apply a theme
        function applyTheme(theme) {
            html.setAttribute("data-theme", theme);
            localStorage.setItem("theme", theme);
            checkbox.checked = theme === "dark";
        }

        // Load saved theme or system preference
        const savedTheme = localStorage.getItem("theme");
        if (savedTheme) {
            applyTheme(savedTheme);
        } else {
            const prefersDark = window.matchMedia("(prefers-color-scheme: dark)").matches;
            applyTheme(prefersDark ? "dark" : "light");
        }

        // Listen for checkbox toggle
        checkbox.addEventListener("change", () => {
            const newTheme = checkbox.checked ? "dark" : "light";
            applyTheme(newTheme);
        });

        // Optional: auto-update theme if system preference changes
        window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change", e => {
            const systemTheme = e.matches ? "dark" : "light";
            // Only apply system theme if user hasn't manually selected one
            if (!localStorage.getItem("theme")) {
                applyTheme(systemTheme);
            }
        });
    });
</script>
